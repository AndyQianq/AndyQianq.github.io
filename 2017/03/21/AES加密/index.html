<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.2 -->
    <script>
        window.materialVersion = "1.5.2"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">



    <link rel="dns-prefetch" href="https://busuanzi.ibruce.info"/>



        <link rel="dns-prefetch" href="https://cdn-city.livere.com"/>










    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            AES加密 | 
        
        Celia‘s blog
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.ico">
    <link rel="icon" href="/img/favicon.png">

    <meta name="format-detection" content="telephone=no"/>
    <meta name="description" itemprop="description" content="">
    <meta name="keywords" content=",cryptology,learning">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?MKetZV3cUTfDxvMffaOezg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Celia‘s blog">
    <meta name="msapplication-starturl" content="http://AndyQianq.github.io/2017/03/21/AES加密/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Celia‘s blog">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Site Verification -->
    
    <meta name="baidu-site-verification" content="cTRbHGxjcP" />

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://AndyQianq.github.io/2017/03/21/AES加密/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="AES加密 | Celia‘s blog">
    <meta property="og:image" content="/img/favicon.png">
    <meta property="og:description" content="">
    <meta property="og:article:tag" content="cryptology"> <meta property="og:article:tag" content="learning"> 

    
        <meta property="article:published_time" content="Tue Mar 21 2017 20:12:13 GMT+0800">
        <meta property="article:modified_time" content="Fri Feb 23 2018 20:55:19 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://AndyQianq.github.io/2017/03/21/AES加密/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "http://AndyQianq.github.io/2017/03/21/AES加密/index.html",
    "headline": "AES加密",
    "datePublished": "Tue Mar 21 2017 20:12:13 GMT+0800",
    "dateModified": "Fri Feb 23 2018 20:55:19 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "Celia Qian",
        "image": {
            "@type": "ImageObject",
            "url": "https://i.loli.net/2018/02/21/5a8c508149164.jpg"
        },
        "description": "C’est la vie"
    },
    "publisher": {
        "@type": "Organization",
        "name": "Celia‘s blog",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.png"
        }
    },
    "keywords": ",cryptology,learning",
    "description": "",
}
</script>


    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#高级加密标准"><span class="post-toc-number">1.</span> <span class="post-toc-text">高级加密标准</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-分组长度"><span class="post-toc-number">1.0.0.1.</span> <span class="post-toc-text">1.分组长度</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-不同在于"><span class="post-toc-number">1.0.0.2.</span> <span class="post-toc-text">2.不同在于</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-迭代密码"><span class="post-toc-number">1.0.0.3.</span> <span class="post-toc-text">3.迭代密码</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-密钥扩展"><span class="post-toc-number">1.0.0.4.</span> <span class="post-toc-text">1.密钥扩展</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-字节代换"><span class="post-toc-number">1.0.0.5.</span> <span class="post-toc-text">2.字节代换</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-行移位"><span class="post-toc-number">1.0.0.6.</span> <span class="post-toc-text">3.行移位</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#4-列混淆"><span class="post-toc-number">1.0.0.7.</span> <span class="post-toc-text">4.列混淆</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-密钥扩展-1"><span class="post-toc-number">1.0.0.8.</span> <span class="post-toc-text">1.密钥扩展</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-字节代换-1"><span class="post-toc-number">1.0.0.9.</span> <span class="post-toc-text">2.字节代换</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-行移位-1"><span class="post-toc-number">1.0.0.10.</span> <span class="post-toc-text">3.行移位</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#4-列混淆-1"><span class="post-toc-number">1.0.0.11.</span> <span class="post-toc-text">4.列混淆</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#5-加密（含密钥加）"><span class="post-toc-number">1.0.0.12.</span> <span class="post-toc-text">5.加密（含密钥加）</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#6-运行加密（并打印S盒）"><span class="post-toc-number">1.0.0.13.</span> <span class="post-toc-text">6.运行加密（并打印S盒）</span></a></li></ol></li></ol></li></ol></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                AES加密
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="https://i.loli.net/2018/02/21/5a8c508149164.jpg" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Celia Qian</strong>
        <span>3月 21, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    
        <button id="article-functions-qrcode-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">devices other</i>
    <span class="visuallyhidden">devices other</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-qrcode-button">
    <li class="mdl-menu__item">在其它设备中阅读本文章</li>
    
        <img src="https://pan.baidu.com/share/qrcode?w=246&h=246&url=http://AndyQianq.github.io/2017/03/21/AES加密/">
    
</ul>

    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/cryptology/">cryptology</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/learning/">learning</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    
        
            <!-- Busuanzi Views -->
            <a class="post_share-link" href="#">
                <li class="mdl-menu__item">
                    <span id="busuanzi_container_page_pv">
                        <span id="busuanzi_value_page_pv"></span>&nbsp;浏览量
                    </span>
                </li>
            </a>
        
    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=AES加密&url=http://AndyQianq.github.io/2017/03/21/AES加密/index.html&pic=http://AndyQianq.github.io/img/favicon.ico&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=AES加密&url=http://AndyQianq.github.io/2017/03/21/AES加密/index.html&via=Celia Qian" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://AndyQianq.github.io/2017/03/21/AES加密/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://AndyQianq.github.io/2017/03/21/AES加密/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h1 id="高级加密标准"><a href="#高级加密标准" class="headerlink" title="高级加密标准"></a>高级加密标准</h1><ul>
<li><p>1997年9月12日NIST（National Institute of Standards and Technology）发布了征集算法公告，要求AES具有128比特的分组长度，并支持128，192和256比特长度的密钥长度，并且要求AES可在全世界范围内免费得到。</p>
</li>
<li><p>1998年6月15日，在提交的21个算法里，有15个满足所有必备的条件并被接纳为AES的候选算法。1999年三月，NIST举行了“第二届AES候选大会”，之后，在1999年8月，5个候选算法入围最后决赛：MARS、RC6、Rijndael、Serpent和Twofish。</p>
</li>
<li><p>2000年10月2日，Rijndael被评为高级加密标准。</p>
</li>
<li><p>说了这么多就是告诉你Rijndael被评为AES是经过层层选拔而来的，是实至名归。<br>那么它究竟怎么实现，才是这篇文章的重点</p>
</li>
<li><p>从上面的文字我们要知道以下几点：</p>
<blockquote>
<p>1.AES具有128比特的分组长度<br>2.AES有三种可选的密钥长度<br>3.AES是一个迭代型密码</p>
</blockquote>
</li>
<li><p>好了我们在分别说一下</p>
<blockquote>
<p>1.什么是分组长度？<br>2.三种可选择的密钥长度有什么不同？<br>3.什么是迭代密码？</p>
</blockquote>
</li>
</ul>
<h4 id="1-分组长度"><a href="#1-分组长度" class="headerlink" title="1.分组长度"></a>1.分组长度</h4><ul>
<li>说到分组长度，自然要讲分组密码</li>
</ul>
<h4 id="2-不同在于"><a href="#2-不同在于" class="headerlink" title="2.不同在于"></a>2.不同在于</h4><ul>
<li><blockquote>
<p>密钥为128比特，则Nr=10<br>密钥为192比特，则Nr=12<br>密钥为256比特，则Nr=14</p>
</blockquote>
</li>
</ul>
<h4 id="3-迭代密码"><a href="#3-迭代密码" class="headerlink" title="3.迭代密码"></a>3.迭代密码</h4><ul>
<li><p>常见的乘积密码是迭代密码</p>
</li>
<li><p>一个典型的迭代密码：这种密码要明确定义一个轮函数和一个密钥编排方案，一个明文的加密将经过Nr轮类似的过程。</p>
</li>
<li><p>注：</p>
<blockquote>
<p>乘积密码（通过“乘积”组合密码体制）<br>“乘积”要满足：<br>具有相同的明文空间（密文空间）<br><img src="https://i.loli.net/2018/02/23/5a90094369388.jpg" alt=""></p>
</blockquote>
</li>
<li><p>说了这么多，大家懂的也不用听我瞎BB（反正这些也是教材上说的），不懂的听我说也是不懂。。。</p>
</li>
<li>下面我们切入正题：</li>
<li><p>首先我们看一下最简单的密钥为128比特的流程图：</p>
<blockquote>
<p><img src="https://i.loli.net/2018/02/23/5a900943a3831.jpg" alt=""></p>
<p>注释：<br>Add round key:密钥加<br>Substitute bytes:字节代换<br>Mix columns:列混淆<br>Shift rows:行移位<br>（只看左边，右边是逆过程。）</p>
</blockquote>
</li>
<li><p>从图中我们可以看出在10轮中</p>
<blockquote>
<p>第一步：明文与密钥加<br>第二步：密钥扩展<br>第三步：进入第一轮<br>…….<br>最后：进入第十轮</p>
</blockquote>
</li>
<li><p>那么每一轮都有什么呢？</p>
<blockquote>
<p>首先我们要注意：前面的几轮与最后一轮是不同的<br>前几轮：1.密钥加，2.字节代换，3.行移位，4.列混淆<br>最后一轮：1.密钥加，2.字节代换，3.行移位<br>所以可以看出列混淆比其他的操作要少一轮！</p>
</blockquote>
</li>
<li><p>密钥加应该都会吧。。。</p>
<blockquote>
<p>例如明文为：<br><img src="https://i.loli.net/2018/02/23/5a900943a58b5.jpg" alt=""><br>密钥为：<br><img src="https://i.loli.net/2018/02/23/5a900943aef21.jpg" alt=""><br>就是每个格子里的数对应\oplus<br>举个例子就是<br>32\oplus 2b<br>因为是16进制数，也就是<br>32：00110010<br>2b：00101011<br>00011001=19</p>
</blockquote>
</li>
<li><p>好接下来我们在解决每一轮的是如何完成这些操作的：</p>
<h4 id="1-密钥扩展"><a href="#1-密钥扩展" class="headerlink" title="1.密钥扩展"></a>1.密钥扩展</h4><blockquote>
<p><img src="https://i.loli.net/2018/02/23/5a900943d2858.jpg" alt=""><br>这里输入128比特的密钥是一位数组，每个元素是16进制，也就是8个比特，共16个元素，要扩展成44个。<br><img src="https://i.loli.net/2018/02/23/5a900a9feb9b9.jpg" alt=""> &gt; <img src="https://i.loli.net/2018/02/23/5a900aa05592f.jpg" alt=""></p>
</blockquote>
</li>
</ul>
<h4 id="2-字节代换"><a href="#2-字节代换" class="headerlink" title="2.字节代换"></a>2.字节代换</h4><blockquote>
<p>字节代换会引入一个S盒的概念，会有人问S盒在不同的算法里是否一致，答案当然是不一样咯。S盒的概念在SPN（代换-置换网络）中有详细的解释，就不多说了。（想知道的，在下一篇文章中再说吧）这里为了方便，姑且认为这个S盒是统一的吧。<br><img src="https://i.loli.net/2018/02/23/5a900aa0b2afa.jpg" alt=""></p>
</blockquote>
<ul>
<li><p>你可以选择在算法里一个个的输入到二维数组中存储，但是。。。。我比较偷懒，所以在找了一个可以计算S盒的算法出自于论文：《AES加密算法中的S盒及其C语言实现》</p>
</li>
<li><p>出处：<a href="http://www.doc88.com/p-5750298893.html" target="_blank" rel="noopener">AES加密算法中的S盒及其C语言实现</a></p>
</li>
<li><p>有了S盒之后，那么只需要将每次密钥加的结果字节代换到S盒中</p>
</li>
<li><p>举个例子就是</p>
<blockquote>
<p><img src="https://i.loli.net/2018/02/23/5a900aa0b42ae.jpg" alt=""><br>以19为例，就是S盒中第1行第9列中的十六进制数为：d4<br>最后的结果就是<br><img src="https://i.loli.net/2018/02/23/5a900aa0ca120.jpg" alt=""></p>
</blockquote>
</li>
</ul>
<h4 id="3-行移位"><a href="#3-行移位" class="headerlink" title="3.行移位"></a>3.行移位</h4><ul>
<li><p>行移位很简单：</p>
<blockquote>
<p>第一行不变<br>第二行每位向左移一位<br>第三行每位向左移两位<br>第四行每位向左移三位<br><img src="https://i.loli.net/2018/02/23/5a900aa0cb875.jpg" alt=""></p>
</blockquote>
</li>
</ul>
<h4 id="4-列混淆"><a href="#4-列混淆" class="headerlink" title="4.列混淆"></a>4.列混淆</h4><ul>
<li><p>列混淆会复杂一点：</p>
</li>
<li><p>大家应该学过线性代数吧，所以这个就是一个行列式的计算，但是这里还有一个多项式的域运算问题：</p>
<blockquote>
<p><img src="https://i.loli.net/2018/02/23/5a900aa10585a.jpg" alt=""><br><img src="https://i.loli.net/2018/02/23/5a900aa16bcd7.jpg" alt=""></p>
</blockquote>
</li>
</ul>
<blockquote>
<p>Xtime就是：<br>D4：11000100<br>因为d4的二进制开头是1<br>所以：<br>从第二位开始向左进一位在最后一位补充0<br>于是：<br>10001000<br>再和“1B”\oplus<br>也就是：<br>10001000<br>00011011<br>结果为：<br>10010011=93<br>（如果开头是0，那么就直接从第二位开始向左移一位，在最后一位补0即可）<br>D4·02=xtime（d4）=93<br>D4·03=d4\oplus xtime（d4）=57<br>11000100<br>10010011<br>01010111=57<br>D4·01=d4<br>那么d4对应的列混淆就是<br>D4·02\oplus d4·03\oplus d4·01\oplus d4·01=04<br>所以最后的结果就是：<br><img src="https://i.loli.net/2018/02/23/5a900aa1a3206.jpg" alt=""></p>
</blockquote>
<ul>
<li><p>好了解决了各个部分之后，我们在来分别实现代码</p>
</li>
<li><p>C语言</p>
</li>
</ul>
<h4 id="1-密钥扩展-1"><a href="#1-密钥扩展-1" class="headerlink" title="1.密钥扩展"></a>1.密钥扩展</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">void KeyExpansion(int sbx_tab[][16],int keys[][44])&#123;</span><br><span class="line">	int Rcon[11]=&#123;0,1,2,4,8,16,32,64,128,27,54&#125;;</span><br><span class="line">	int past[4];</span><br><span class="line">	int i,j;</span><br><span class="line">	printf(&quot;input the keys:\n&quot;);</span><br><span class="line">	for(i=0;i&lt;4;i++)</span><br><span class="line">		for(j=0;j&lt;4;j++)</span><br><span class="line">			scanf(&quot;%x&quot;,&amp;keys[j][i]);</span><br><span class="line">		for(i=4;i&lt;44;i++)</span><br><span class="line">		&#123;</span><br><span class="line">			if(i%4==0)&#123;</span><br><span class="line">				for(j=1;j&lt;=4;j++)</span><br><span class="line">					past[j-1]=keys[j%4][i-1];</span><br><span class="line">				for(j=0;j&lt;4;j++)&#123;</span><br><span class="line">					if(j==0)</span><br><span class="line">						keys[j][i]=sbx_tab[past[j]/16][past[j]%16]^Rcon[i/4]^keys[j][i-4];</span><br><span class="line">					else</span><br><span class="line">						keys[j][i]=sbx_tab[past[j]/16][past[j]%16]^keys[j][i-4];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			else&#123;</span><br><span class="line">				for(j=0;j&lt;4;j++)&#123;</span><br><span class="line">					keys[j][i]=keys[j][i-4]^keys[j][i-1];</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="2-字节代换-1"><a href="#2-字节代换-1" class="headerlink" title="2.字节代换"></a>2.字节代换</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//SubByte字节替换</span><br><span class="line">void SubByte(int sbx_tab[][16],int B[][4])</span><br><span class="line">&#123;</span><br><span class="line">	int i,j;</span><br><span class="line">	for(i=0;i&lt;4;i++)</span><br><span class="line">		for(j=0;j&lt;4;j++)&#123;</span><br><span class="line">			B[i][j]=B[i][j]%256;</span><br><span class="line">			B[i][j]=sbx_tab[B[i][j]/16][B[i][j]%16];</span><br><span class="line">		&#125;</span><br><span class="line">	for(i=0;i&lt;4;i++)&#123;</span><br><span class="line">		for(j=0;j&lt;4;j++)</span><br><span class="line">			printf(&quot;%X &quot;,B[i][j]);</span><br><span class="line">		printf(&quot;\n&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="3-行移位-1"><a href="#3-行移位-1" class="headerlink" title="3.行移位"></a>3.行移位</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">//ShitfRow行移位</span><br><span class="line">void ShiftRow(int B[][4])&#123;</span><br><span class="line">		int m=1;</span><br><span class="line">		int i,j;</span><br><span class="line">	while(m&lt;4)&#123;</span><br><span class="line">	for(i=m;i&lt;4;i++)</span><br><span class="line">	&#123;	</span><br><span class="line">		int tem = B[i][0];</span><br><span class="line">		for (j=0;j&lt;3;j++)</span><br><span class="line">			B[i][j] = B[i][j+1];</span><br><span class="line">		B[i][3] = tem;</span><br><span class="line">	&#125;</span><br><span class="line">	m++;</span><br><span class="line">	&#125;</span><br><span class="line">	for(i=0;i&lt;4;i++)&#123;</span><br><span class="line">		for(j=0;j&lt;4;j++)</span><br><span class="line">			printf(&quot;%x &quot;,B[i][j]);</span><br><span class="line">		printf(&quot;\n&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-列混淆-1"><a href="#4-列混淆-1" class="headerlink" title="4.列混淆"></a>4.列混淆</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">int Xtime(int input)&#123;</span><br><span class="line">	int temp;</span><br><span class="line">	temp=input&lt;&lt;1;</span><br><span class="line">	if(input&amp;0x80)</span><br><span class="line">	&#123;</span><br><span class="line">		temp^=0x1b;</span><br><span class="line">	&#125;</span><br><span class="line">	return temp;</span><br><span class="line">&#125;</span><br><span class="line">//MixColumn列混淆</span><br><span class="line">void MixColumn(int input[][4])</span><br><span class="line">&#123;</span><br><span class="line">	int i,j;</span><br><span class="line">	int output[4][4];</span><br><span class="line">	for(j=0;j&lt;4;j++)</span><br><span class="line">		for(i=0;i&lt;4;i++)//0x02乘法//0x03乘法//0x01乘法//0x01乘法</span><br><span class="line">			output[i][j]=Xtime(input[i%4][j])^(input[(i+1)%4][j]^Xtime(input[(i+1)%4][j]))^input[(i+2)%4][j]^input[(i+3)%4][j];</span><br><span class="line">		for(i=0;i&lt;4;i++)</span><br><span class="line">			for(j=0;j&lt;4;j++)</span><br><span class="line">				input[i][j]=output[i][j];</span><br><span class="line">		for(i=0;i&lt;4;i++)&#123;</span><br><span class="line">			for(j=0;j&lt;4;j++)</span><br><span class="line">				printf(&quot;%02X &quot;,output[i][j]);				</span><br><span class="line">			printf(&quot;\n&quot;);</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="5-加密（含密钥加）"><a href="#5-加密（含密钥加）" class="headerlink" title="5.加密（含密钥加）"></a>5.加密（含密钥加）</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">//加密</span><br><span class="line">int AES_Encrypt(int sbx_tab[][16])</span><br><span class="line">&#123;</span><br><span class="line">	int e;</span><br><span class="line">	int plain[4][4];</span><br><span class="line">	int keys[4][44];</span><br><span class="line">	int i,j,level;</span><br><span class="line">	</span><br><span class="line">	printf(&quot;\nplease input the plaintext to encryot information:&quot;);</span><br><span class="line">    for(i=0;i&lt;4;i++)</span><br><span class="line">		for(j=0;j&lt;4;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			scanf(&quot;%X&quot;,&amp;e);</span><br><span class="line">			plain[j][i]=e;</span><br><span class="line">		&#125;</span><br><span class="line">	getchar();</span><br><span class="line">	KeyExpansion(sbx_tab,keys);</span><br><span class="line">	printf(&quot;\n*********************[1]************************\n&quot;);</span><br><span class="line">	printf(&quot;Start of [1] round:\n&quot;);</span><br><span class="line">	for(i=0;i&lt;4;i++)&#123;</span><br><span class="line">		for(j=0;j&lt;4;j++)&#123;</span><br><span class="line">		   plain[i][j]^=keys[i][j];</span><br><span class="line">	       printf(&quot;%x &quot;,plain[i][j]);</span><br><span class="line">		&#125;</span><br><span class="line">		printf(&quot;\n&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	printf(&quot;the Key of [1] round:\n&quot;);</span><br><span class="line">	for(i=0;i&lt;4;i++)&#123;</span><br><span class="line">		for(j=0;j&lt;4;j++)&#123;</span><br><span class="line">	       printf(&quot;%x &quot;,keys[i][j]);</span><br><span class="line">		&#125;</span><br><span class="line">		printf(&quot;\n&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	   for(level=1;level&lt;10;level++)</span><br><span class="line">	   &#123;</span><br><span class="line">		   printf(&quot;the SubByte of [%d] round:\n&quot;,level);</span><br><span class="line">		   SubByte(sbx_tab,plain);</span><br><span class="line">		   printf(&quot;the ShiftRow of [%d] round:\n&quot;,level);</span><br><span class="line">		   ShiftRow(plain);</span><br><span class="line">		   printf(&quot;the MixColumn of [%d] round:\n&quot;,level);</span><br><span class="line">		   MixColumn(plain);</span><br><span class="line">		   printf(&quot;\n&quot;);</span><br><span class="line">		   printf(&quot;*********************[%d]************************\n&quot;,level+1);</span><br><span class="line">		   printf(&quot;start of [%d] round:\n&quot;,level+1);</span><br><span class="line">		   for(i=0;i&lt;4;i++)&#123;</span><br><span class="line">			   for(j=0;j&lt;4;j++)&#123;</span><br><span class="line">				   plain[i][j]^=keys[i][level*4+j];</span><br><span class="line">				   printf(&quot;%x &quot;,plain[i][j]);</span><br><span class="line">				   &#125;			  </span><br><span class="line">			   printf(&quot;\n&quot;);</span><br><span class="line">		   &#125;</span><br><span class="line">		   printf(&quot;the Keys of [%d] round  is:\n&quot;,level+1);</span><br><span class="line">		   for(i=0;i&lt;4;i++)&#123; </span><br><span class="line">			   for(j=0;j&lt;4;j++)&#123;</span><br><span class="line">				  printf(&quot;%x &quot;,keys[i][level*4+j]);</span><br><span class="line">				   &#125;</span><br><span class="line">			   printf(&quot;\n&quot;);</span><br><span class="line">		   &#125;</span><br><span class="line">	   &#125;</span><br><span class="line">	   printf(&quot;the SubByte of [10] round:\n&quot;);</span><br><span class="line">	   SubByte(sbx_tab,plain);//第十轮循环，注意第十轮加密没有进行列混淆</span><br><span class="line">	   printf(&quot;the ShiftRow of [10] round:\n&quot;);</span><br><span class="line">	   ShiftRow(plain);</span><br><span class="line">	   for(i=0;i&lt;4;i++)	</span><br><span class="line">		   for(j=0;j&lt;4;j++)</span><br><span class="line">			   plain[i][j]^=keys[i][40+j];</span><br><span class="line">	   printf(&quot;*******************************************\n&quot;);</span><br><span class="line">	   printf(&quot;the ciphertext is:\n&quot;);</span><br><span class="line">	   for(i=0;i&lt;4;i++)&#123;	</span><br><span class="line">		   for(j=0;j&lt;4;j++)</span><br><span class="line">			   printf(&quot;%x &quot;, plain[i][j]);</span><br><span class="line">		   printf(&quot;\n&quot;);</span><br><span class="line">	   &#125;</span><br><span class="line">		return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="6-运行加密（并打印S盒）"><a href="#6-运行加密（并打印S盒）" class="headerlink" title="6.运行加密（并打印S盒）"></a>6.运行加密（并打印S盒）</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">int main()&#123;</span><br><span class="line">	int pow_tab[256];		</span><br><span class="line">	int log_tab[256];</span><br><span class="line">	int mid_tab[256];</span><br><span class="line">	int sbx_tab[256];</span><br><span class="line">	int b[8]=&#123;0xf1,0xe3,0xc7,0x8f,0x1f,0x3e,0x7c,0xf8&#125;;</span><br><span class="line">	int i,j,k,p;</span><br><span class="line">	//S盒生成</span><br><span class="line">	for(i=0,p=1;i&lt;256;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		pow_tab[i]=p;</span><br><span class="line">		log_tab[p]=i;</span><br><span class="line">		p=p^(p&lt;&lt;1)^(p&amp;0x80?0x11b:0);</span><br><span class="line">	&#125;</span><br><span class="line">	for(i=0;i&lt;256;i++)</span><br><span class="line">		mid_tab[i]=(i?pow_tab[255-log_tab[i]]:0);</span><br><span class="line">	for(i=0;i&lt;256;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		int t=0,m=0,mid=0,tab=0;</span><br><span class="line">		for(j=0;j&lt;8;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			m=mid=(b[j]&amp;mid_tab[i]);</span><br><span class="line">			for(k=0;k&lt;8;k++)</span><br><span class="line">			&#123;</span><br><span class="line">				int n=(mid&gt;&gt;1);</span><br><span class="line">				if(m!=(n&lt;&lt;1))</span><br><span class="line">					t++;</span><br><span class="line">				mid=n;</span><br><span class="line">				m=mid;</span><br><span class="line">			&#125;</span><br><span class="line">			if(t%2&gt;0)</span><br><span class="line">			&#123;</span><br><span class="line">				int temp=1;</span><br><span class="line">				for(k=0;k&lt;j;k++)</span><br><span class="line">					temp=temp&lt;&lt;1;</span><br><span class="line">				tab+=temp;</span><br><span class="line">			&#125;</span><br><span class="line">			t=0;</span><br><span class="line">		&#125;</span><br><span class="line">		sbx_tab[i]=tab^0x63;</span><br><span class="line">	&#125;</span><br><span class="line">	printf(&quot;***********AES_Encipher***********\n&quot;);</span><br><span class="line">	printf(&quot;the S_Box is:&quot;);</span><br><span class="line">	for(i=0;i&lt;256;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		if((i+16)%16==0)printf(&quot;\n&quot;);</span><br><span class="line">		printf(&quot;%X &quot;,sbx_tab[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	//将sbx_tab放入Temp_tab中去(从一维转入二维)</span><br><span class="line">	int Temp_tab[16][16];</span><br><span class="line">	for(i=0;i&lt;256;i++)</span><br><span class="line">		Temp_tab[i/16][i%16]=sbx_tab[i];</span><br><span class="line">	AES_Encrypt(Temp_tab);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>注：每一轮的结果也是有输出的，但是这里就没有粘贴了</li>
<li>结果<blockquote>
<p><img src="https://i.loli.net/2018/02/23/5a900eb465c7e.jpg" alt="1.jpg"><br><img src="https://i.loli.net/2018/02/23/5a900eb477aa0.jpg" alt="2.jpg"><br><img src="https://i.loli.net/2018/02/23/5a900eb4ae053.jpg" alt="3.jpg"></p>
</blockquote>
</li>
<li>花了3天时间，每天晚上2个小时，再加上一个下午3个小时，终于弄完了，希望对大家有用。</li>
</ul>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 来必力 -->
<div id="livere-comment">
    <div id="lv-container" data-id="city" data-uid="MTAyMC8zNDE3MS8xMDcwOA==">
	<script type="text/ls-javascript" id="livere-comment-js">
   (function(d, s) {
       var j, e = d.getElementsByTagName(s)[0];
       if (typeof LivereTower === 'function') { return; }
       j = d.createElement(s);
       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
       j.async = true;
       e.parentNode.insertBefore(j, e);
   })(document, 'script');
	</script>
</div>
</div>
<style>
    #livere-comment{
        background-color: #eee;
        padding: 2pc;
    }
</style>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/04/13/legendre-Jacobi/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/03/21/东京教父/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="https://i.loli.net/2018/02/21/5a8c508149164.jpg" alt="Celia Qian's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        only@celiay.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto: only@celiay.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
                <li>
                    <a href="/resume.html" target="_blank" title="Resume">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">explorer</i>
                        
                        Resume
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2018/03/">三月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/02/">二月 2018<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/12/">十二月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/09/">九月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/07/">七月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/04/">四月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">三月 2017<span class="sidebar_archives-count">2</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">apps</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/hobbies/">hobbies<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/movies/">movies<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/music/">music<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/notes/">notes<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/school-work/">school work<span class="sidebar_archives-count">6</span></a>
            </ul>
        </li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/about.html" title="About">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                About
            </a>
        </li>
        
    
        <li>
            <a href="/tags.html" title="Tags">
                
                    <i class="material-icons sidebar-material-icons">bookmark</i>
                
                Tags
            </a>
        </li>
        
    
        <li>
            <a href="/gallery.html" title="Galleries">
                
                    <i class="material-icons sidebar-material-icons">photo</i>
                
                Galleries
            </a>
        </li>
        
    
        <li>
            <a href="/links.html" title="Friends">
                
                    <i class="material-icons sidebar-material-icons">people</i>
                
                Friends
            </a>
        </li>
        
            <li class="divider"></li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">12</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    
        <a href="http://weibo.com/010798QQ" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-weibo">
                <span class="visuallyhidden">Weibo</span>
            </button><!--
     --></a>
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/AndyQianq" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    
        <a href="https://www.zhihu.com/people/shi-da-jia-16/activities" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-zhihu">
                <span class="visuallyhidden">Zhihu</span>
            </button><!--
     --></a>
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>Celia‘s blog
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?V/53wGualMuiPM3xoetD5Q==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>







    <!-- Busuanzi -->
    <script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



   





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->



<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.2 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
